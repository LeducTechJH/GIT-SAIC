package gov.dlf.logic;


import gov.dlf.external.*;
import gov.dlf.facade.*;
import gov.dlf.presentation.*;


import java.util.*;

import net.maintrend.appmanager.*;
import net.maintrend.datamanager.*;
import net.maintrend.interfaces.*;
import net.maintrend.interlink.*;
import net.maintrend.mdi.*;
import net.maintrend.rallyengine.*;
import net.maintrend.util.*;
import net.maintrend.util.format.*;



/**
 * __Comment
 *
 * Generated by Rally-to-Java Convertor. MainTrend Ltd.
 */
public class FECHAS_SERV_REVISION_UPDATE_ADL
     extends ADL
{
  // -------------------------------------------------------------------
  // ----------   Class Attributes   -----------------------------------

  /**  */
  public static boolean staticCall = false;



  // -------------------------------------------------------------------
  // ----------   Instance Attributes   --------------------------------

  /**  */
  public SAIC_DMQ_ORA_Application app;
  /**  */
  public RallyDataManager dm = null;



  // -------------------------------------------------------------------
  // ----------   Instance Condition Attributes   ----------------------

  public boolean _condition0 = false;

  public boolean _condition1 = false;

  public boolean _condition2 = false;



  // -------------------------------------------------------------------
  // ----------   Instance Export Attributes   -------------------------

  public double OPEN_ID = 0;

  public double OPEN_ID2 = 0;

  public double STATUS_ID = 0;

  public double STATUS_CODE = 0;

  public double NUMNULL = 0;

  public double CODE_STATUS = 0;

  public double OPEN_CLT = 0;



  public String COD_SERV = null;

  public String UPD_FLG = null;

  public String NULLBOY = null;

  public DataStore CLIENTES_READ_LOC_DSD = null;

  public DataStore SERVICIOS_TBL_RO_DSD = null;



  // -------------------------------------------------------------------
  // ----------   Instance Attributes' Access Methods   ----------------


  /**  */
  public static void setOPEN_ID  ( RallyApplication __app, Parameter value )
  {
    ( ( FECHAS_SERV_REVISION_UPDATE_ADL ) __app.getADL ( FECHAS_SERV_REVISION_UPDATE_ADL.class ) ).OPEN_ID = value.getDouble ( );
  }


  /**  */
  public static void setOPEN_ID2  ( RallyApplication __app, Parameter value )
  {
    ( ( FECHAS_SERV_REVISION_UPDATE_ADL ) __app.getADL ( FECHAS_SERV_REVISION_UPDATE_ADL.class ) ).OPEN_ID2 = value.getDouble ( );
  }


  /**  */
  public static void setSTATUS_ID  ( RallyApplication __app, Parameter value )
  {
    ( ( FECHAS_SERV_REVISION_UPDATE_ADL ) __app.getADL ( FECHAS_SERV_REVISION_UPDATE_ADL.class ) ).STATUS_ID = value.getDouble ( );
  }


  /**  */
  public static void setSTATUS_CODE  ( RallyApplication __app, Parameter value )
  {
    ( ( FECHAS_SERV_REVISION_UPDATE_ADL ) __app.getADL ( FECHAS_SERV_REVISION_UPDATE_ADL.class ) ).STATUS_CODE = value.getDouble ( );
  }


  /**  */
  public static void setCOD_SERV  ( RallyApplication __app, Parameter value )
  {
    ( ( FECHAS_SERV_REVISION_UPDATE_ADL ) __app.getADL ( FECHAS_SERV_REVISION_UPDATE_ADL.class ) ).COD_SERV = value.getString ( );
  }


  /**  */
  public static void setUPD_FLG  ( RallyApplication __app, Parameter value )
  {
    ( ( FECHAS_SERV_REVISION_UPDATE_ADL ) __app.getADL ( FECHAS_SERV_REVISION_UPDATE_ADL.class ) ).UPD_FLG = value.getString ( );
  }


  /**  */
  public static void setNULLBOY  ( RallyApplication __app, Parameter value )
  {
    ( ( FECHAS_SERV_REVISION_UPDATE_ADL ) __app.getADL ( FECHAS_SERV_REVISION_UPDATE_ADL.class ) ).NULLBOY = value.getString ( );
  }


  /**  */
  public static void setNUMNULL  ( RallyApplication __app, Parameter value )
  {
    ( ( FECHAS_SERV_REVISION_UPDATE_ADL ) __app.getADL ( FECHAS_SERV_REVISION_UPDATE_ADL.class ) ).NUMNULL = value.getDouble ( );
  }


  /**  */
  public static void setCODE_STATUS  ( RallyApplication __app, Parameter value )
  {
    ( ( FECHAS_SERV_REVISION_UPDATE_ADL ) __app.getADL ( FECHAS_SERV_REVISION_UPDATE_ADL.class ) ).CODE_STATUS = value.getDouble ( );
  }


  /**  */
  public static void setOPEN_CLT  ( RallyApplication __app, Parameter value )
  {
    ( ( FECHAS_SERV_REVISION_UPDATE_ADL ) __app.getADL ( FECHAS_SERV_REVISION_UPDATE_ADL.class ) ).OPEN_CLT = value.getDouble ( );
  }



  /**  */
  public static String getCOD_SERV  ( RallyApplication __app )
  {
    return ( ( FECHAS_SERV_REVISION_UPDATE_ADL ) __app.getADL ( FECHAS_SERV_REVISION_UPDATE_ADL.class ) ).COD_SERV;
  }


  /**  */
  public static void setCOD_SERV  ( RallyApplication __app, String value )
  {
    ( ( FECHAS_SERV_REVISION_UPDATE_ADL ) __app.getADL ( FECHAS_SERV_REVISION_UPDATE_ADL.class ) ).COD_SERV = value;
  }


  /**  */
  public static void setCOD_SERV  ( RallyApplication __app, Object value )
  {
    ( ( FECHAS_SERV_REVISION_UPDATE_ADL ) __app.getADL ( FECHAS_SERV_REVISION_UPDATE_ADL.class ) ).COD_SERV = ( String ) value;
  }



  /**  */
  public static String getUPD_FLG  ( RallyApplication __app )
  {
    return ( ( FECHAS_SERV_REVISION_UPDATE_ADL ) __app.getADL ( FECHAS_SERV_REVISION_UPDATE_ADL.class ) ).UPD_FLG;
  }


  /**  */
  public static void setUPD_FLG  ( RallyApplication __app, String value )
  {
    ( ( FECHAS_SERV_REVISION_UPDATE_ADL ) __app.getADL ( FECHAS_SERV_REVISION_UPDATE_ADL.class ) ).UPD_FLG = value;
  }


  /**  */
  public static void setUPD_FLG  ( RallyApplication __app, Object value )
  {
    ( ( FECHAS_SERV_REVISION_UPDATE_ADL ) __app.getADL ( FECHAS_SERV_REVISION_UPDATE_ADL.class ) ).UPD_FLG = ( String ) value;
  }



  /**  */
  public static String getNULLBOY  ( RallyApplication __app )
  {
    return ( ( FECHAS_SERV_REVISION_UPDATE_ADL ) __app.getADL ( FECHAS_SERV_REVISION_UPDATE_ADL.class ) ).NULLBOY;
  }


  /**  */
  public static void setNULLBOY  ( RallyApplication __app, String value )
  {
    ( ( FECHAS_SERV_REVISION_UPDATE_ADL ) __app.getADL ( FECHAS_SERV_REVISION_UPDATE_ADL.class ) ).NULLBOY = value;
  }


  /**  */
  public static void setNULLBOY  ( RallyApplication __app, Object value )
  {
    ( ( FECHAS_SERV_REVISION_UPDATE_ADL ) __app.getADL ( FECHAS_SERV_REVISION_UPDATE_ADL.class ) ).NULLBOY = ( String ) value;
  }



  /**  */
  public static DataStore getCLIENTES_READ_LOC_DSD  ( RallyApplication __app )
  {
    return ( ( FECHAS_SERV_REVISION_UPDATE_ADL ) __app.getADL ( FECHAS_SERV_REVISION_UPDATE_ADL.class ) ).CLIENTES_READ_LOC_DSD;
  }


  /**  */
  public static void setCLIENTES_READ_LOC_DSD  ( RallyApplication __app, DataStore value )
  {
    ( ( FECHAS_SERV_REVISION_UPDATE_ADL ) __app.getADL ( FECHAS_SERV_REVISION_UPDATE_ADL.class ) ).CLIENTES_READ_LOC_DSD = value;
  }


  /**  */
  public static void setCLIENTES_READ_LOC_DSD  ( RallyApplication __app, Object value )
  {
    ( ( FECHAS_SERV_REVISION_UPDATE_ADL ) __app.getADL ( FECHAS_SERV_REVISION_UPDATE_ADL.class ) ).CLIENTES_READ_LOC_DSD = ( DataStore ) value;
  }



  /**  */
  public static DataStore getSERVICIOS_TBL_RO_DSD  ( RallyApplication __app )
  {
    return ( ( FECHAS_SERV_REVISION_UPDATE_ADL ) __app.getADL ( FECHAS_SERV_REVISION_UPDATE_ADL.class ) ).SERVICIOS_TBL_RO_DSD;
  }


  /**  */
  public static void setSERVICIOS_TBL_RO_DSD  ( RallyApplication __app, DataStore value )
  {
    ( ( FECHAS_SERV_REVISION_UPDATE_ADL ) __app.getADL ( FECHAS_SERV_REVISION_UPDATE_ADL.class ) ).SERVICIOS_TBL_RO_DSD = value;
  }


  /**  */
  public static void setSERVICIOS_TBL_RO_DSD  ( RallyApplication __app, Object value )
  {
    ( ( FECHAS_SERV_REVISION_UPDATE_ADL ) __app.getADL ( FECHAS_SERV_REVISION_UPDATE_ADL.class ) ).SERVICIOS_TBL_RO_DSD = ( DataStore ) value;
  }




  /**  */
  public static double getOPEN_ID  ( RallyApplication __app )
  {
    return ( ( FECHAS_SERV_REVISION_UPDATE_ADL ) __app.getADL ( FECHAS_SERV_REVISION_UPDATE_ADL.class ) ).OPEN_ID;
  }


  /**  */
  public static Double getOPEN_IDDouble ( RallyApplication __app )
  {
    return new Double ( ( ( FECHAS_SERV_REVISION_UPDATE_ADL ) __app.getADL ( FECHAS_SERV_REVISION_UPDATE_ADL.class ) ).OPEN_ID );
  }


  /**  */
  public static void setOPEN_ID  ( RallyApplication __app, double value )
  {
    ( ( FECHAS_SERV_REVISION_UPDATE_ADL ) __app.getADL ( FECHAS_SERV_REVISION_UPDATE_ADL.class ) ).OPEN_ID = value;
  }


  /**  */
  public static void setOPEN_ID  ( RallyApplication __app, Object value )
  {
    ( ( FECHAS_SERV_REVISION_UPDATE_ADL ) __app.getADL ( FECHAS_SERV_REVISION_UPDATE_ADL.class ) ).OPEN_ID = ( ( Double ) value ).doubleValue ( );
  }


  /**  */
  public static double getOPEN_ID2  ( RallyApplication __app )
  {
    return ( ( FECHAS_SERV_REVISION_UPDATE_ADL ) __app.getADL ( FECHAS_SERV_REVISION_UPDATE_ADL.class ) ).OPEN_ID2;
  }


  /**  */
  public static Double getOPEN_ID2Double ( RallyApplication __app )
  {
    return new Double ( ( ( FECHAS_SERV_REVISION_UPDATE_ADL ) __app.getADL ( FECHAS_SERV_REVISION_UPDATE_ADL.class ) ).OPEN_ID2 );
  }


  /**  */
  public static void setOPEN_ID2  ( RallyApplication __app, double value )
  {
    ( ( FECHAS_SERV_REVISION_UPDATE_ADL ) __app.getADL ( FECHAS_SERV_REVISION_UPDATE_ADL.class ) ).OPEN_ID2 = value;
  }


  /**  */
  public static void setOPEN_ID2  ( RallyApplication __app, Object value )
  {
    ( ( FECHAS_SERV_REVISION_UPDATE_ADL ) __app.getADL ( FECHAS_SERV_REVISION_UPDATE_ADL.class ) ).OPEN_ID2 = ( ( Double ) value ).doubleValue ( );
  }


  /**  */
  public static double getSTATUS_ID  ( RallyApplication __app )
  {
    return ( ( FECHAS_SERV_REVISION_UPDATE_ADL ) __app.getADL ( FECHAS_SERV_REVISION_UPDATE_ADL.class ) ).STATUS_ID;
  }


  /**  */
  public static Double getSTATUS_IDDouble ( RallyApplication __app )
  {
    return new Double ( ( ( FECHAS_SERV_REVISION_UPDATE_ADL ) __app.getADL ( FECHAS_SERV_REVISION_UPDATE_ADL.class ) ).STATUS_ID );
  }


  /**  */
  public static void setSTATUS_ID  ( RallyApplication __app, double value )
  {
    ( ( FECHAS_SERV_REVISION_UPDATE_ADL ) __app.getADL ( FECHAS_SERV_REVISION_UPDATE_ADL.class ) ).STATUS_ID = value;
  }


  /**  */
  public static void setSTATUS_ID  ( RallyApplication __app, Object value )
  {
    ( ( FECHAS_SERV_REVISION_UPDATE_ADL ) __app.getADL ( FECHAS_SERV_REVISION_UPDATE_ADL.class ) ).STATUS_ID = ( ( Double ) value ).doubleValue ( );
  }


  /**  */
  public static double getSTATUS_CODE  ( RallyApplication __app )
  {
    return ( ( FECHAS_SERV_REVISION_UPDATE_ADL ) __app.getADL ( FECHAS_SERV_REVISION_UPDATE_ADL.class ) ).STATUS_CODE;
  }


  /**  */
  public static Double getSTATUS_CODEDouble ( RallyApplication __app )
  {
    return new Double ( ( ( FECHAS_SERV_REVISION_UPDATE_ADL ) __app.getADL ( FECHAS_SERV_REVISION_UPDATE_ADL.class ) ).STATUS_CODE );
  }


  /**  */
  public static void setSTATUS_CODE  ( RallyApplication __app, double value )
  {
    ( ( FECHAS_SERV_REVISION_UPDATE_ADL ) __app.getADL ( FECHAS_SERV_REVISION_UPDATE_ADL.class ) ).STATUS_CODE = value;
  }


  /**  */
  public static void setSTATUS_CODE  ( RallyApplication __app, Object value )
  {
    ( ( FECHAS_SERV_REVISION_UPDATE_ADL ) __app.getADL ( FECHAS_SERV_REVISION_UPDATE_ADL.class ) ).STATUS_CODE = ( ( Double ) value ).doubleValue ( );
  }


  /**  */
  public static double getNUMNULL  ( RallyApplication __app )
  {
    return ( ( FECHAS_SERV_REVISION_UPDATE_ADL ) __app.getADL ( FECHAS_SERV_REVISION_UPDATE_ADL.class ) ).NUMNULL;
  }


  /**  */
  public static Double getNUMNULLDouble ( RallyApplication __app )
  {
    return new Double ( ( ( FECHAS_SERV_REVISION_UPDATE_ADL ) __app.getADL ( FECHAS_SERV_REVISION_UPDATE_ADL.class ) ).NUMNULL );
  }


  /**  */
  public static void setNUMNULL  ( RallyApplication __app, double value )
  {
    ( ( FECHAS_SERV_REVISION_UPDATE_ADL ) __app.getADL ( FECHAS_SERV_REVISION_UPDATE_ADL.class ) ).NUMNULL = value;
  }


  /**  */
  public static void setNUMNULL  ( RallyApplication __app, Object value )
  {
    ( ( FECHAS_SERV_REVISION_UPDATE_ADL ) __app.getADL ( FECHAS_SERV_REVISION_UPDATE_ADL.class ) ).NUMNULL = ( ( Double ) value ).doubleValue ( );
  }


  /**  */
  public static double getCODE_STATUS  ( RallyApplication __app )
  {
    return ( ( FECHAS_SERV_REVISION_UPDATE_ADL ) __app.getADL ( FECHAS_SERV_REVISION_UPDATE_ADL.class ) ).CODE_STATUS;
  }


  /**  */
  public static Double getCODE_STATUSDouble ( RallyApplication __app )
  {
    return new Double ( ( ( FECHAS_SERV_REVISION_UPDATE_ADL ) __app.getADL ( FECHAS_SERV_REVISION_UPDATE_ADL.class ) ).CODE_STATUS );
  }


  /**  */
  public static void setCODE_STATUS  ( RallyApplication __app, double value )
  {
    ( ( FECHAS_SERV_REVISION_UPDATE_ADL ) __app.getADL ( FECHAS_SERV_REVISION_UPDATE_ADL.class ) ).CODE_STATUS = value;
  }


  /**  */
  public static void setCODE_STATUS  ( RallyApplication __app, Object value )
  {
    ( ( FECHAS_SERV_REVISION_UPDATE_ADL ) __app.getADL ( FECHAS_SERV_REVISION_UPDATE_ADL.class ) ).CODE_STATUS = ( ( Double ) value ).doubleValue ( );
  }


  /**  */
  public static double getOPEN_CLT  ( RallyApplication __app )
  {
    return ( ( FECHAS_SERV_REVISION_UPDATE_ADL ) __app.getADL ( FECHAS_SERV_REVISION_UPDATE_ADL.class ) ).OPEN_CLT;
  }


  /**  */
  public static Double getOPEN_CLTDouble ( RallyApplication __app )
  {
    return new Double ( ( ( FECHAS_SERV_REVISION_UPDATE_ADL ) __app.getADL ( FECHAS_SERV_REVISION_UPDATE_ADL.class ) ).OPEN_CLT );
  }


  /**  */
  public static void setOPEN_CLT  ( RallyApplication __app, double value )
  {
    ( ( FECHAS_SERV_REVISION_UPDATE_ADL ) __app.getADL ( FECHAS_SERV_REVISION_UPDATE_ADL.class ) ).OPEN_CLT = value;
  }


  /**  */
  public static void setOPEN_CLT  ( RallyApplication __app, Object value )
  {
    ( ( FECHAS_SERV_REVISION_UPDATE_ADL ) __app.getADL ( FECHAS_SERV_REVISION_UPDATE_ADL.class ) ).OPEN_CLT = ( ( Double ) value ).doubleValue ( );
  }



  // -------------------------------------------------------------------
  // ----------   Methods   --------------------------------------------

  /**
   *
   * @param __app
   * @return
   */
  public static FECHAS_SERV_REVISION_UPDATE_ADL get ( RallyApplication __app )
  {
    FECHAS_SERV_REVISION_UPDATE_ADL adl = new FECHAS_SERV_REVISION_UPDATE_ADL ( );
    __app.register ( adl, "FECHAS_SERV_REVISION_UPDATE_ADL" );
    __app.setADL ( FECHAS_SERV_REVISION_UPDATE_ADL.class, adl );
    adl.setApplication ( __app );
    return adl;
  }


  /**
   *
   * @param __app
   * @param ps
   *
   * @return
   */
  public static void exec ( RallyApplication __app, ParameterSet ps )
  {
    FECHAS_SERV_REVISION_UPDATE_ADL.get ( __app ).process ( ps );
  }


  /**
   *
   * @param __app
   *
   * @return
   */
  public static void exec ( RallyApplication __app )
  {
    ParameterSet ps = null;
    FECHAS_SERV_REVISION_UPDATE_ADL.exec ( __app, ps );
  }


  /**
   * Overrides the ancestor's method
   *
   * @param __app
   */
  public void setApplication ( RallyApplication __app )
  {
    this.app = ( SAIC_DMQ_ORA_Application ) __app;
    if ( this.app != null )
    {
      this.dm = ( RallyDataManager ) this.app.getDataManager ( );
    }
  }


  /**
   * Overrides the ancestor's method
   *
   * @param parms
   */
  public void execute ( ParameterSet parms )
  {
    this.process ( parms );
  }




  /**
   *
   */
  protected void doReturn ( )
  {
    this.unregister ( );
  }


  /**
   *
   */
  public void unregister ( )
  {
    this.app.unregister ( this );
    IRegisteredObject rObj = this.app.get ( "FECHAS_SERV_REVISION_UPDATE_ADL" );
    if ( rObj != null && rObj instanceof FECHAS_SERV_REVISION_UPDATE_ADL )
    {
      this.app.setADL ( FECHAS_SERV_REVISION_UPDATE_ADL.class, ( FECHAS_SERV_REVISION_UPDATE_ADL ) rObj );
    }
  }


  /**
   * Overrides the ancestor's method
   *
   * @param ps
   */
  protected void process ( ParameterSet ps )
  {
    Debug.println ( Debug.TRACE, "FECHAS_SERV_REVISION_UPDATE_ADL Step " + this.currentStep );
    super.process ( ps );
    switch ( this.currentStep )
    {
      case 0:  { this.currentStep ++; this.step0 ( this.keyParms ); break; }
      case 1:  { this.currentStep ++; this.step1 ( this.keyParms ); break; }
      case 2:  { this.currentStep ++; this.step2 ( this.keyParms ); break; }
      case 3:  { this.currentStep ++; this.step3 ( this.keyParms ); break; }
      case 4:  { this.currentStep ++; this.step4 ( this.keyParms ); break; }
      case 5:  { this.currentStep ++; this.step5 ( this.keyParms ); break; }
      default:
      {
        this.currentStep = 0;
        Debug.println ( Debug.TRACE, "FECHAS_SERV_REVISION_UPDATE_ADL ended" );
        this.unregister ( );
        break;
      }
    }
    if ( this.currentStep > 0 ) this.app.goOn ( );
  }



  /**
   *
   */
  protected void step0 ( ParameterSet ps )
  {

    this.app.FLAG_UPD_GBL = "S";
    NULLBOY = TruncService.setNull ( NULLBOY  );
    NUMNULL = TruncService.setNull ( NUMNULL  );
    CHECK_ID_AUTORIZA_ADL.exec ( this.app );
    return;

  }


  /**
   *
   */
  protected void step1 ( ParameterSet ps )
  {

    if ( Compare.equals ( this.app.COD_ACCESS_GBL, "CERT" ) )
    {
      this._condition0 = true;
    }
    else
    {
      this._condition0 = false;
    }
    if ( this._condition0 )
    {
      CLIENTES_READ_LOC_DSD = this.dm.create ( "CLIENTES_READ_LOC_DSD" );
      OPEN_CLT = CLIENTES_READ_LOC_DSD.getId ( );
      CODE_STATUS = RallyDataStoreException.getDefault ( );

      CODE_STATUS  = this.dm.reset ( OPEN_CLT );

      this.dm.setField ( this.dm.get ( "CLIENTES_READ_LOC_DSD" ), "SEGURO_SOCIAL_JEFE_FAMILIA", this.app.SSN_JEFE_FAM_GBL );
      this.dm.setField ( this.dm.get ( "CLIENTES_READ_LOC_DSD" ), "RMO_OFICINA", this.app.RMO_GBL );

      CODE_STATUS  = this.dm.limitQueryFromBuffer ( OPEN_CLT );
      CODE_STATUS  = this.dm.retrieve ( OPEN_CLT );

      CODE_STATUS  = this.dm.firstRow ( OPEN_CLT );

      this.process ( ps );
    }

  }


  /**
   *
   */
  protected void step2 ( ParameterSet ps )
  {
    if ( this._condition0 )    //    if ( Compare.equals ( this.app.COD_ACCESS_GBL, "CERT" ) )
    {
      if ( Compare.equals ( CODE_STATUS, 0 )  )
      {
        this._condition1 = true;
      }
      else
      {
        this._condition1 = false;
      }
      if ( this._condition1 )
      {
        if ( ( Compare.equals ( this.dm.getFieldString ( this.dm.get ( "CLIENTES_READ_LOC_DSD" ), "COD_PARENTESCO_FAM" ), "" ) ) || ( Compare.equals ( this.dm.getFieldString ( this.dm.get ( "CLIENTES_READ_LOC_DSD" ), "COD_PARENTESCO_FAM" ), NULLBOY ) ) )
        {
          this._condition2 = true;
        }
        else
        {
          this._condition2 = false;
        }
        if ( this._condition2 )
        {
          this.app.setError ( 0, 5539 );
          MANTENIMIENTO_DE_CASOS_ADL.setCOMPLETION_STATUS ( this.app, "FAILURE" );
          this.app.errorFlag = false;
          this.app.callCommand ( RallyAppCommandFactory.IGNORE );
          return;
        }
      }
    }

  }


  /**
   *
   */
  protected void step3 ( ParameterSet ps )
  {

    if ( this._condition0 )    //    if ( Compare.equals ( this.app.COD_ACCESS_GBL, "CERT" ) )
    {
      if ( this._condition1 )    //      while ( Compare.equals ( CODE_STATUS, 0 )  )
      {
        if ( this._condition2 )    //        if ( ( Compare.equals ( this.dm.getFieldString ( this.dm.get ( "CLIENTES_READ_LOC_DSD" ), "COD_PARENTESCO_FAM" ), "" ) ) || ( Compare.equals ( this.dm.getFieldString ( this.dm.get ( "CLIENTES_READ_LOC_DSD" ), "COD_PARENTESCO_FAM" ), NULLBOY ) ) )
        {
        }

        CODE_STATUS  = this.dm.nextRow ( OPEN_CLT );

        this.currentStep = 2;
        return;
      }
    }

  }


  /**
   *
   */
  protected void step4 ( ParameterSet ps )
  {
    double doubleTemp = 0;
    double doubleNextTemp = 0;
    if ( ( Compare.equals ( this.app.MANT_ACCION_SERV_GBL, "RS" ) ) || ( Compare.equals ( this.app.MANT_ACCION_SERV_GBL, "RR" ) ) || ( Compare.equals ( this.app.MANT_ACCION_SERV_GBL, "RF" ) ) || ( Compare.equals ( this.app.MANT_ACCION_SERV_GBL, "RO" ) ) )
    {
      if ( ( Compare.equals ( this.app.form ( "FECHAS_SERVICIO_FRM" ).getStringItem ( "COD_STATUS_SERVICIO" ), "INACTIVO" ) ) && ( Compare.lt ( this.app.form ( "FECHAS_SERVICIO_FRM" ).getDateItem ( "FCH_TERMINACION" ), this.app.SYSTEM_DATE ) )  )
      {
        this.doReturn ( );
        return;
      }
      else
      {
        this.app.form ( "FECHAS_SERVICIO_FRM" ).setItem ( "ID_TECNICO_REVISA", this.app.ID_TECNICO_GBL  );
        this.app.form ( "FECHAS_SERVICIO_FRM" ).setItem ( "FCH_REVICION", TruncService.trunc ( this.app.SYSTEM_DATE, "DDD" )   );
        COD_SERV = this.app.form ( "FECHAS_SERVICIO_FRM" ).getStringItem ( "COD_SERVICIO" );
        SERVICIOS_TBL_RO_DSD = this.dm.create ( "SERVICIOS_TBL_RO_DSD" );
        OPEN_ID = SERVICIOS_TBL_RO_DSD.getId ( );
        STATUS_ID = RallyDataStoreException.getDefault ( );

        STATUS_ID  = this.dm.reset ( OPEN_ID );

        this.dm.setField ( this.dm.get ( "SERVICIOS_TBL_RO_DSD" ), "COD_SERVICIO", COD_SERV );

        STATUS_ID  = this.dm.limitQueryFromBuffer ( OPEN_ID );
        STATUS_ID  = this.dm.retrieve ( OPEN_ID );

        STATUS_ID  = this.dm.firstRow ( OPEN_ID );

        this.app.form ( "SERV_FAM_FRM" ).setItem ( "FCH_TERMINACION", this.app.form ( "FECHAS_SERVICIO_FRM" ).getDateItem ( "FCH_TERMINACION" ) );
        this.app.form ( "SERV_FAM_FRM" ).setItem ( "NUM_MESES", this.app.form ( "FECHAS_SERVICIO_FRM" ).getDoubleItem ( "NUM_MESES" ) );
        this.app.form ( "SERV_FAM_FRM" ).setItem ( "FCH_COMIENZO", this.app.form ( "FECHAS_SERVICIO_FRM" ).getDateItem ( "FCH_COMIENZO" ) );
        this.app.form ( "SERV_FAM_FRM" ).setItem ( "FCH_REVICION", this.app.form ( "FECHAS_SERVICIO_FRM" ).getDateItem ( "FCH_REVICION" ) );
        if ( Compare.equals ( this.dm.getFieldString ( this.dm.get ( "SERVICIOS_TBL_RO_DSD" ), "FLG_PROVEEDOR_REQUERIDO" ), "S" ) )
        {
          this.app.form ( "FECHAS_SERVICIO_FRM" ).setItem ( "COD_STATUS_SERVICIO", "PENDPROV"  );
          this.app.form ( "SERV_FAM_FRM" ).setItem ( "COD_STATUS_SERVICIO", "PENDPROV"  );
          this.app.form ( "PRE_MENU_MANT_SERV_FR" ).setItem ( "COD_STATUS_SERVICIO", "PENDPROV"  );
          this.app.form ( "PRE_MENU_MANT_SERV_FR" ).setItem ( "FCH_TERMINACION", this.app.form ( "FECHAS_SERVICIO_FRM" ).getDateItem ( "FCH_TERMINACION" ) );
          this.app.form ( "PRE_MENU_MANT_SERV_FR" ).setItem ( "NUM_MESES", this.app.form ( "FECHAS_SERVICIO_FRM" ).getDoubleItem ( "NUM_MESES" ) );
        }
        else
        {
          doubleTemp = this.app.form ( "FECHAS_SERVICIO_FRM" ).getDoubleItem ( "CONTEO_60_MESES_TANF_VAR" );
          if ( Double.isNaN ( doubleTemp ) ) doubleTemp = 0;
          if ( ( Compare.gt ( MathService.plus ( doubleTemp, this.app.form ( "FECHAS_SERVICIO_FRM" ).getDoubleItem ( "NUM_MESES" ) ), 60 ) ) && ( Compare.equals ( this.app.form ( "FECHAS_SERVICIO_FRM" ).getStringItem ( "RAZON_60_MESES" ), "" ) )  && ( Compare.equals ( this.app.form ( "FECHAS_SERVICIO_FRM" ).getStringItem ( "COD_SERVICIO" ), "AE-C" ) )  )
          {
        	//***** Start Mods. by L. Leduc / J. Olmeda -- 10/5/2010 *****
            this.app.setError ( 1, 7951 );
            this.app.errorFlag = false;
        	//***** End Mods. by L. Leduc / J. Olmeda -- 10/5/2010 *****
            this.doReturn ( );
            return;
          }
          if ( ( Compare.gt ( MathService.plus ( doubleTemp, this.app.form ( "FECHAS_SERVICIO_FRM" ).getDoubleItem ( "NUM_MESES" ) ), 72 ) ) && ( Compare.equals ( this.app.form ( "FECHAS_SERVICIO_FRM" ).getStringItem ( "COD_SERVICIO" ), "AE-C" ) )  )
          {
          	//***** Start Mods. by L. Leduc / J. Olmeda -- 10/5/2010 *****
            this.app.setError ( 1, 7979 );
            this.app.errorFlag = false;
        	//***** End Mods. by L. Leduc / J. Olmeda -- 10/5/2010 *****
            this.doReturn ( );
            return;
          }
          if ( ( ( ( Compare.equals ( this.app.RUTINA_GBL, "MC" ) ) || ( Compare.equals ( this.app.RUTINA_GBL, "IR" ) ) || ( Compare.equals ( this.app.RUTINA_GBL, "AC" ) ) ) 
        		  && ( Compare.equals ( this.app.AUTORIZADA_GBL, "N" ) )  )
        		  || ( ( Compare.gt ( MathService.plus ( this.app.form ( "FECHAS_SERVICIO_FRM" ).getDoubleItem ( "CONTEO_60_MESES_TANF_VAR" ), this.app.form ( "FECHAS_SERVICIO_FRM" ).getDoubleItem ( "NUM_MESES" ) ), 60 ) ) && ( Compare.equals ( this.app.form ( "FECHAS_SERVICIO_FRM" ).getStringItem ( "COD_SERVICIO" ), "AE-C" ) )  ) )
          {
            this.app.form ( "FECHAS_SERVICIO_FRM" ).setItem ( "COD_STATUS_SERVICIO", "PENDAUTO"  );
            this.app.form ( "SERV_FAM_FRM" ).setItem ( "COD_STATUS_SERVICIO", "PENDAUTO"  );
            this.app.form ( "PRE_MENU_MANT_SERV_FR" ).setItem ( "COD_STATUS_SERVICIO", "PENDAUTO"  );
            this.app.form ( "PRE_MENU_MANT_SERV_FR" ).setItem ( "FCH_TERMINACION", this.app.form ( "FECHAS_SERVICIO_FRM" ).getDateItem ( "FCH_TERMINACION" ) );
            this.app.form ( "PRE_MENU_MANT_SERV_FR" ).setItem ( "NUM_MESES", this.app.form ( "FECHAS_SERVICIO_FRM" ).getDoubleItem ( "NUM_MESES" ) );
          }
          else if ( ( Compare.equals ( this.app.RUTINA_GBL, "MC" ) ) || ( Compare.equals ( this.app.RUTINA_GBL, "AC" ) )  )
          {
            doubleTemp = this.app.form ( "FECHAS_SERVICIO_FRM" ).getDoubleItem ( "VLR_BENEFICIOS" );
            if ( Double.isNaN ( doubleTemp ) ) doubleTemp = 0;
            doubleNextTemp = this.app.form ( "FECHAS_SERVICIO_FRM" ).getDoubleItem ( "VLR_BENEFICIO_ANTERIOR" );
            if ( Double.isNaN ( doubleNextTemp ) ) doubleTemp = 0;
            if ( ( Compare.ge ( doubleTemp, doubleNextTemp ) ) || ( Compare.equals ( this.app.form ( "FECHAS_SERVICIO_FRM" ).getStringItem ( "COD_STATUS_SERVICIO" ), "ACCNEG" ) ) || ( Compare.equals ( this.app.RECERT_TIPO_GBL, "D" ) ) || ( Compare.equals ( this.app.RECERT_TIPO_GBL, "P" ) ) || ( Compare.equals ( this.app.RECERT_TIPO_GBL, "A" ) ) || ( Compare.equals ( this.app.RECERT_TIPO_GBL, "S" ) ) )
            {
              if ( Compare.gt ( doubleTemp, 0 ) )
              {
                this.app.form ( "FECHAS_SERVICIO_FRM" ).setItem ( "COD_STATUS_SERVICIO", "ACTIVO"  );
                this.app.form ( "SERV_FAM_FRM" ).setItem ( "COD_STATUS_SERVICIO", "ACTIVO"  );
                this.app.form ( "PRE_MENU_MANT_SERV_FR" ).setItem ( "COD_STATUS_SERVICIO", "ACTIVO"  );
                this.app.form ( "FECHAS_SERVICIO_FRM" ).setItem ( "ULT_BENEFICIO", this.app.form ( "FECHAS_SERVICIO_FRM" ).getDoubleItem ( "VLR_BENEFICIO_ANTERIOR" ) );
                this.app.form ( "FECHAS_SERVICIO_FRM" ).setItem ( "VLR_BENEFICIO_ANTERIOR", this.app.form ( "FECHAS_SERVICIO_FRM" ).getDoubleItem ( "VLR_BENEFICIOS" ) );
                this.app.FLAG_UPD_GBL = "S";
              }
              else
              {
                this.app.form ( "FECHAS_SERVICIO_FRM" ).setItem ( "COD_STATUS_SERVICIO", "CERRAD12"  );
                this.app.form ( "FECHAS_SERVICIO_FRM" ).setItem ( "FCH_CERRADO", this.app.SYSTEM_DATE  );
                this.app.form ( "SERV_FAM_FRM" ).setItem ( "COD_STATUS_SERVICIO", "CERRAD12"  );
                this.app.form ( "PRE_MENU_MANT_SERV_FR" ).setItem ( "COD_STATUS_SERVICIO", "CERRAD12"  );
                this.app.FLAG_UPD_GBL = "S";
              }
            }
            else
            {
              if ( Compare.gt ( this.app.form ( "FECHAS_SERVICIO_FRM" ).getDoubleItem ( "VLR_BENEFICIOS" ), 0 ) )
              {
                if ( Compare.equals ( RallyStringService.subString ( this.app.form ( "FECHAS_SERVICIO_FRM" ).getStringItem ( "COD_SERVICIO" ), 0, 3 ), "PAN" ) )
                {
                  this.app.form ( "FECHAS_SERVICIO_FRM" ).setItem ( "COD_STATUS_SERVICIO", "ACTIVO"  );
                  this.app.form ( "SERV_FAM_FRM" ).setItem ( "COD_STATUS_SERVICIO", "ACTIVO"  );
                  this.app.form ( "PRE_MENU_MANT_SERV_FR" ).setItem ( "COD_STATUS_SERVICIO", "ACTIVO"  );
                  this.app.form ( "PRE_MENU_MANT_SERV_FR" ).setItem ( "FCH_TERMINACION", this.app.form ( "FECHAS_SERVICIO_FRM" ).getDateItem ( "FCH_TERMINACION" ) );
                  this.app.form ( "FECHAS_SERVICIO_FRM" ).setItem ( "ULT_BENEFICIO", this.app.form ( "FECHAS_SERVICIO_FRM" ).getDoubleItem ( "VLR_BENEFICIO_ANTERIOR" ) );
                  this.app.form ( "FECHAS_SERVICIO_FRM" ).setItem ( "VLR_BENEFICIO_ANTERIOR", this.app.form ( "FECHAS_SERVICIO_FRM" ).getDoubleItem ( "VLR_BENEFICIOS" ) );
                  this.app.form ( "PRE_MENU_MANT_SERV_FR" ).setItem ( "NUM_MESES", this.app.form ( "FECHAS_SERVICIO_FRM" ).getDoubleItem ( "NUM_MESES" ) );
                  this.app.FLAG_UPD_GBL = "S";
                }
                else
                {
                  this.app.form ( "FECHAS_SERVICIO_FRM" ).setItem ( "COD_STATUS_SERVICIO", "ACCNEG"  );
                  this.app.form ( "SERV_FAM_FRM" ).setItem ( "COD_STATUS_SERVICIO", "ACCNEG"  );
                  this.app.form ( "PRE_MENU_MANT_SERV_FR" ).setItem ( "COD_STATUS_SERVICIO", "ACCNEG"  );
                  this.app.form ( "PRE_MENU_MANT_SERV_FR" ).setItem ( "FCH_TERMINACION", this.app.form ( "FECHAS_SERVICIO_FRM" ).getDateItem ( "FCH_TERMINACION" ) );
                  this.app.form ( "PRE_MENU_MANT_SERV_FR" ).setItem ( "NUM_MESES", this.app.form ( "FECHAS_SERVICIO_FRM" ).getDoubleItem ( "NUM_MESES" ) );
                  this.app.FLAG_UPD_GBL = "N";
                }
              }
              else
              {
                this.app.form ( "FECHAS_SERVICIO_FRM" ).setItem ( "COD_STATUS_SERVICIO", "CERRAD12"  );
                this.app.form ( "FECHAS_SERVICIO_FRM" ).setItem ( "FCH_CERRADO", this.app.SYSTEM_DATE  );
                this.app.form ( "SERV_FAM_FRM" ).setItem ( "COD_STATUS_SERVICIO", "CERRAD12"  );
                this.app.form ( "PRE_MENU_MANT_SERV_FR" ).setItem ( "COD_STATUS_SERVICIO", "CERRAD12"  );
                this.app.FLAG_UPD_GBL = "S";
              }
            }
            if ( ( Compare.equals ( this.app.RUTINA_GBL, "AC" ) ) || ( Compare.equals ( this.app.RECERT_TIPO_GBL, "D" ) ) )
            {
              if ( ( Compare.equals ( this.app.AUTORIZADA_GBL, "S" ) ) && 
            		  ( ( ( Compare.gt ( MathService.plus ( this.app.form ( "FECHAS_SERVICIO_FRM" ).getDoubleItem ( "CONTEO_60_MESES_TANF_VAR" ), this.app.form ( "FECHAS_SERVICIO_FRM" ).getDoubleItem ( "NUM_MESES" ) ), 60 ) ) && ( ! Compare.equals ( this.app.form ( "FECHAS_SERVICIO_FRM" ).getStringItem ( "COD_SERVICIO" ), "AE-C" ) )  ) || ( Compare.le ( MathService.plus ( this.app.form ( "FECHAS_SERVICIO_FRM" ).getDoubleItem ( "CONTEO_60_MESES_TANF_VAR" ), this.app.form ( "FECHAS_SERVICIO_FRM" ).getDoubleItem ( "NUM_MESES" ) ), 60 ) ) )  )
              {
                this.app.form ( "FECHAS_SERVICIO_FRM" ).setItem ( "COD_STATUS_SERVICIO", "ACTIVO"  );
                this.app.form ( "SERV_FAM_FRM" ).setItem ( "COD_STATUS_SERVICIO", "ACTIVO"  );
                this.app.form ( "PRE_MENU_MANT_SERV_FR" ).setItem ( "COD_STATUS_SERVICIO", "ACTIVO"  );
                this.app.form ( "PRE_MENU_MANT_SERV_FR" ).setItem ( "FCH_TERMINACION", this.app.form ( "FECHAS_SERVICIO_FRM" ).getDateItem ( "FCH_TERMINACION" ) );
                this.app.form ( "PRE_MENU_MANT_SERV_FR" ).setItem ( "NUM_MESES", this.app.form ( "FECHAS_SERVICIO_FRM" ).getDoubleItem ( "NUM_MESES" ) );
              }
              else
              {
                this.app.form ( "FECHAS_SERVICIO_FRM" ).setItem ( "COD_STATUS_SERVICIO", "PENDAUTO"  );
                this.app.form ( "SERV_FAM_FRM" ).setItem ( "COD_STATUS_SERVICIO", "PENDAUTO"  );
                this.app.form ( "PRE_MENU_MANT_SERV_FR" ).setItem ( "COD_STATUS_SERVICIO", "PENDAUTO"  );
                this.app.form ( "PRE_MENU_MANT_SERV_FR" ).setItem ( "FCH_TERMINACION", this.app.form ( "FECHAS_SERVICIO_FRM" ).getDateItem ( "FCH_TERMINACION" ) );
                this.app.form ( "PRE_MENU_MANT_SERV_FR" ).setItem ( "NUM_MESES", this.app.form ( "FECHAS_SERVICIO_FRM" ).getDoubleItem ( "NUM_MESES" ) );
                if ( ! Compare.equals ( STATUS_CODE, 0 ) )
                {
                  this.app.setError ( 1, STATUS_CODE );
                  this.doReturn ( );
                  return;
                }
                this.app.form ( "FECHAS_SERVICIO_FRM" ).setItem ( "ULT_BENEFICIO", this.app.form ( "FECHAS_SERVICIO_FRM" ).getDoubleItem ( "VLR_BENEFICIO_ANTERIOR" ) );
                this.app.form ( "FECHAS_SERVICIO_FRM" ).setItem ( "VLR_BENEFICIO_ANTERIOR", this.app.form ( "FECHAS_SERVICIO_FRM" ).getDoubleItem ( "VLR_BENEFICIOS" ) );
              }
            }
          }
          STATUS_ID  = this.dm.dbClose ( OPEN_ID );

        }
      }
    }
    if ( Compare.equals ( this.app.MANT_ACCION_SERV_GBL, "AP" ) )
    {
      this.app.form ( "SERV_FAM_FRM" ).setItem ( "ID_PROVEEDOR", this.app.form ( "FECHAS_SERVICIO_FRM" ).getDoubleItem ( "ID_PROVEEDOR" ) );
      if ( ( Compare.equals ( this.app.RECERT_TIPO_GBL, "N" ) ) || ( Compare.equals ( this.app.RECERT_TIPO_GBL, "D" ) ) )
      {
        this.app.form ( "FECHAS_SERVICIO_FRM" ).setItem ( "COD_STATUS_SERVICIO", "PENDAUTO"  );
        this.app.form ( "SERV_FAM_FRM" ).setItem ( "COD_STATUS_SERVICIO", "PENDAUTO"  );
        this.app.form ( "PRE_MENU_MANT_SERV_FR" ).setItem ( "COD_STATUS_SERVICIO", "PENDAUTO"  );
        this.app.form ( "PRE_MENU_MANT_SERV_FR" ).setItem ( "FCH_TERMINACION", this.app.form ( "FECHAS_SERVICIO_FRM" ).getDateItem ( "FCH_TERMINACION" ) );
        this.app.form ( "PRE_MENU_MANT_SERV_FR" ).setItem ( "NUM_MESES", this.app.form ( "FECHAS_SERVICIO_FRM" ).getDoubleItem ( "NUM_MESES" ) );
      }
      else
      {
        this.app.form ( "FECHAS_SERVICIO_FRM" ).setItem ( "COD_STATUS_SERVICIO", "ACTIVO"  );
        this.app.form ( "SERV_FAM_FRM" ).setItem ( "COD_STATUS_SERVICIO", "ACTIVO"  );
        this.app.form ( "PRE_MENU_MANT_SERV_FR" ).setItem ( "COD_STATUS_SERVICIO", "ACTIVO"  );
        this.app.form ( "PRE_MENU_MANT_SERV_FR" ).setItem ( "FCH_TERMINACION", this.app.form ( "FECHAS_SERVICIO_FRM" ).getDateItem ( "FCH_TERMINACION" ) );
        this.app.form ( "PRE_MENU_MANT_SERV_FR" ).setItem ( "NUM_MESES", this.app.form ( "FECHAS_SERVICIO_FRM" ).getDoubleItem ( "NUM_MESES" ) );
      }
    }
    if ( Compare.equals ( this.app.MANT_ACCION_SERV_GBL, "RP" ) )
    {
      this.app.form ( "SERV_FAM_FRM" ).setItem ( "ID_PROVEEDOR", this.app.form ( "FECHAS_SERVICIO_FRM" ).getDoubleItem ( "ID_PROVEEDOR" ) );
    }
    if ( Compare.equals ( this.app.MANT_ACCION_SERV_GBL, "AS" ) )
    {
      if ( ( Compare.equals ( RallyStringService.subString ( this.app.form ( "FECHAS_SERVICIO_FRM" ).getStringItem ( "COD_SERVICIO" ), 0, 4 ), "PANE" ) ) || ( Compare.equals ( RallyStringService.subString ( this.app.form ( "FECHAS_SERVICIO_FRM" ).getStringItem ( "COD_SERVICIO" ), 0, 2 ), "LI" ) ) )
      {
    	//Mods by Marcos Acevedo, KPG Inc. Cambio para que los codigos de servicio PANED activen con estatus ACTIVO.
//    	if ( Compare.equals (  this.app.form ( "FECHAS_SERVICIO_FRM" ).getStringItem ( "COD_SERVICIO" ), "PANED" ) )
//    	{
//    		this.app.form ( "FECHAS_SERVICIO_FRM" ).setItem ( "COD_STATUS_SERVICIO", "ACTIVO"  );
//            this.app.form ( "SERV_FAM_FRM" ).setItem ( "COD_STATUS_SERVICIO", "ACTIVO"  );
//            this.app.form ( "PRE_MENU_MANT_SERV_FR" ).setItem ( "COD_STATUS_SERVICIO", "ACTIVO"  );
//            this.app.form ( "PRE_MENU_MANT_SERV_FR" ).setItem ( "FCH_TERMINACION", this.app.form ( "FECHAS_SERVICIO_FRM" ).getDateItem ( "FCH_TERMINACION" ) );
//            this.app.form ( "FECHAS_SERVICIO_FRM" ).setItem ( "ULT_BENEFICIO", this.app.form ( "FECHAS_SERVICIO_FRM" ).getDoubleItem ( "VLR_BENEFICIO_ANTERIOR" ) );
//            this.app.form ( "FECHAS_SERVICIO_FRM" ).setItem ( "VLR_BENEFICIO_ANTERIOR", this.app.form ( "FECHAS_SERVICIO_FRM" ).getDoubleItem ( "VLR_BENEFICIOS" ) );
//            this.app.form ( "PRE_MENU_MANT_SERV_FR" ).setItem ( "NUM_MESES", this.app.form ( "FECHAS_SERVICIO_FRM" ).getDoubleItem ( "NUM_MESES" ) );
//            this.app.FLAG_UPD_GBL = "S";
//
//    	}
//    	else
//    	{
    		this.app.form ( "FECHAS_SERVICIO_FRM" ).setItem ( "COD_STATUS_SERVICIO", "ACTIVO"  );
    		this.app.form ( "FECHAS_SERVICIO_FRM" ).setItem ( "FCH_CERRADO", this.app.SYSTEM_DATE  );
    		this.app.form ( "SERV_FAM_FRM" ).setItem ( "COD_STATUS_SERVICIO", "ACTIVO"  );
    		this.app.form ( "PRE_MENU_MANT_SERV_FR" ).setItem ( "COD_STATUS_SERVICIO", "ACTIVO"  );
//    	}
      }
      else
      {
    	  if(Compare.equals(this.app.ANSWER_GBL, "S"))
    	  {
        this.app.form ( "FECHAS_SERVICIO_FRM" ).setItem ( "COD_STATUS_SERVICIO", "ACTIVO"  );
        this.app.form ( "SERV_FAM_FRM" ).setItem ( "COD_STATUS_SERVICIO", "ACTIVO"  );
        this.app.form ( "PRE_MENU_MANT_SERV_FR" ).setItem ( "COD_STATUS_SERVICIO", "ACTIVO"  );
        this.app.form ( "FECHAS_SERVICIO_FRM" ).setItem ( "ULT_BENEFICIO", this.app.form ( "FECHAS_SERVICIO_FRM" ).getDoubleItem ( "VLR_BENEFICIO_ANTERIOR" ) );
        this.app.form ( "FECHAS_SERVICIO_FRM" ).setItem ( "VLR_BENEFICIO_ANTERIOR", this.app.form ( "FECHAS_SERVICIO_FRM" ).getDoubleItem ( "VLR_BENEFICIOS" ) );
    	  }
    	  else
    	  {
    		  this.app.form ( "FECHAS_SERVICIO_FRM" ).setItem ( "COD_STATUS_SERVICIO", "PENDCERT"  );
    	        this.app.form ( "SERV_FAM_FRM" ).setItem ( "COD_STATUS_SERVICIO", "PENDCERT"  );
    	        this.app.form ( "PRE_MENU_MANT_SERV_FR" ).setItem ( "COD_STATUS_SERVICIO", "PENDCERT"  );
    	  }
      }
    }
    if ( Compare.equals ( this.app.MANT_ACCION_SERV_GBL, "LI" ) )
    {
      this.app.form ( "SERV_FAM_FRM" ).setItem ( "ID_TECNICO", this.app.form ( "FECHAS_SERVICIO_FRM" ).getDoubleItem ( "ID_TECNICO" ) );
    }
    if ( Compare.equals ( this.app.MANT_ACCION_SERV_GBL, "FS" ) )
    {
      this.app.form ( "SERV_FAM_FRM" ).setItem ( "FCH_TERMINACION", this.app.form ( "FECHAS_SERVICIO_FRM" ).getDateItem ( "FCH_TERMINACION" ) );
      this.app.form ( "SERV_FAM_FRM" ).setItem ( "NUM_MESES", this.app.form ( "FECHAS_SERVICIO_FRM" ).getDoubleItem ( "NUM_MESES" ) );
      this.app.form ( "SERV_FAM_FRM" ).setItem ( "FCH_COMIENZO", this.app.form ( "FECHAS_SERVICIO_FRM" ).getDateItem ( "FCH_COMIENZO" ) );
      this.app.form ( "PRE_MENU_MANT_SERV_FR" ).setItem ( "FCH_COMIENZO", this.app.form ( "FECHAS_SERVICIO_FRM" ).getDateItem ( "FCH_COMIENZO" ) );
      this.app.form ( "PRE_MENU_MANT_SERV_FR" ).setItem ( "FCH_TERMINACION", this.app.form ( "FECHAS_SERVICIO_FRM" ).getDateItem ( "FCH_TERMINACION" ) );
      this.app.form ( "PRE_MENU_MANT_SERV_FR" ).setItem ( "NUM_MESES", this.app.form ( "FECHAS_SERVICIO_FRM" ).getDoubleItem ( "NUM_MESES" ) );
    }
    if ( Compare.equals ( this.app.MANT_ACCION_SERV_GBL, "CB" ) )
    {
      this.app.form ( "SERV_FAM_FRM" ).setItem ( "VLR_BENEFICIO", this.app.form ( "FECHAS_SERVICIO_FRM" ).getDoubleItem ( "VLR_BENEFICIOS" ) );
    }
    if ( ( Compare.equals ( this.app.MANT_ACCION_SERV_GBL, "CS" ) ) || ( Compare.equals ( this.app.MANT_ACCION_SERV_GBL, "IS" ) ) )
    {
      this.app.form ( "SERV_FAM_FRM" ).setItem ( "COD_STATUS_SERVICIO", this.app.form ( "FECHAS_SERVICIO_FRM" ).getStringItem ( "COD_STATUS_SERVICIO" ) );
      this.app.form ( "PRE_MENU_MANT_SERV_FR" ).setItem ( "COD_STATUS_SERVICIO", this.app.form ( "FECHAS_SERVICIO_FRM" ).getStringItem ( "COD_STATUS_SERVICIO" ) );
      this.doReturn ( );
      return;
    }
    int LAST_COMMAND = RallyAppCommandFactory.translate ( this.app.getLastCommandName ( ) );
    if ( ! Compare.equals ( LAST_COMMAND, RallyAppCommandFactory.EXITACTION ) )
    {
      this.app.form ( "FECHAS_SERVICIO_FRM" ).resetChangeStatus ( );
      this.app.getLastForm ( "FECHAS_SERVICIO_FRM" ).setUpdateOnInstanceChange ( false );
      this.app.callCommand ( RallyAppCommandFactory.QBE );
    }
    return;

  }


  /**
   *
   */
  protected void step5 ( ParameterSet ps )
  {
    int LAST_COMMAND = RallyAppCommandFactory.translate ( this.app.getLastCommandName ( ) );
    if ( ! Compare.equals ( LAST_COMMAND, RallyAppCommandFactory.EXITACTION ) )
    {
      this.app.callCommand ( RallyAppCommandFactory.QUERY );
    }
    return;

  }
}



/* ---------------------------------------------------------------------



PROCEDURE FECHAS_SERV_REVISION_UPDATE_ADL;

VAR

        OPEN_ID:        NUMBER(9,0);
        OPEN_ID2:       NUMBER(9,0);
        STATUS_ID:      NUMBER(9,0);
        STATUS_CODE:    NUMBER;
        COD_SERV:       CHAR(5);
        UPD_FLG:        CHAR(1) EXPORT;
        NULLBOY:        CHAR;
        NUMNULL :       NUMBER;
        CODe_STATUS:    NUMBER;
        OPEN_CLT:       NUMBER;
BEGIN
SET_TRACE();

FLAG_UPD_GBL := 'S';

MAKE_NULL(NULLBOY);
MAKE_NULL(NUMNULL);

        CALL CHECK_ID_AUTORIZA_ADL;
{       DB_OPEN(SERVICIOS2_DSD,OPEN_ID2,STATUS_CODE); }
        if cod_access_gbl = 'CERT'
        then
        begin
        db_open(CLIENTES_READ_LOC_DSD,open_clt,code_status);
        db_reset(open_clt,code_status);
                clientes_read_loc_dsd.seguro_social_jefe_familia := SSN_JEFE_FAM
_GBL;
                CLIENTES_READ_LOC_DSD.RMO_OFICINA := RMO_GBL;
        db_query(open_clt,code_status);
        db_get_first(open_clt,code_status);
        while code_status = 0 do
            begin
            if ((clientes_read_loc_dsd.COD_PARENTESCO_FAM = '') OR
                   (clientes_read_loc_dsd.COD_PARENTESCO_FAM = NULLBOY))
            THEN BEGIN
                   ERROR(5539);
                   MANTENIMIENTO_DE_CASOS_ADL.COMPLETION_STATUS:='FAILURE';
                   set_failure();
                   CALL_CMD('IGNORE');
                END;
            db_get_next(open_clt,code_status);
            end;
        end;

{REVISION DEL SERVICIO OU RECERTIFICACION }
IF (MANT_ACCION_SERV_GBL='RS') OR
   (MANT_ACCION_SERV_GBL='RR') OR
   (MANT_ACCION_SERV_GBL='RF') OR
   (MANT_ACCION_SERV_GBL='RO')
{ISP 15-OCT-2005 VALIDACION PARA QUE LOS INACTIVOS CON FECHAS VENCIDAS NO
PASEN A ACTIVOS. REVISADO EL 24-MAY-2006 POR ERROR CON EMERGENCIAS  ISP}
  THEN BEGIN
   IF (FECHAS_SERVICIO_FRM.COD_STATUS_SERVICIO = 'INACTIVO') AND
      (FECHAS_SERVICIO_FRM.FCH_TERMINACION < SYSTEM_DATE) THEN
       BEGIN
           RETURN;
       END;
   ELSE BEGIN

        FECHAS_SERVICIO_FRM.ID_TECNICO_REVISA:=ID_TECNICO_GBL;
        FECHAS_SERVICIO_FRM.FCH_REVICION:=TRUNC(SYSTEM_DATE,'DDD');
        COD_SERV:=FECHAS_SERVICIO_FRM.COD_SERVICIO;
        DB_OPEN(SERVICIOS_TBL_RO_DSD,OPEN_ID,STATUS_ID);
        DB_RESET(OPEN_ID,STATUS_ID);
        SERVICIOS_TBL_RO_DSD.COD_SERVICIO:=COD_SERV;
        DB_QUERY(OPEN_ID,STATUS_ID);
        DB_GET_FIRST(OPEN_ID,STATUS_ID);
         SERV_FAM_FRM.FCH_TERMINACION:=FECHAS_SERVICIO_FRM.FCH_TERMINACION;
         SERV_FAM_FRM.NUM_MESES:=FECHAS_SERVICIO_FRM.NUM_MESES;
         SERV_FAM_FRM.FCH_COMIENZO := FECHAS_SERVICIO_FRM.FCH_COMIENZO;
         SERV_FAM_FRM.FCH_REVICION := FECHAS_SERVICIO_FRM.FCH_REVICION;
        IF SERVICIOS_TBL_RO_DSD.FLG_PROVEEDOR_REQUERIDO='S'
           THEN BEGIN
                 FECHAS_SERVICIO_FRM.COD_STATUS_SERVICIO:='PENDPROV';
                 SERV_FAM_FRM.COD_STATUS_SERVICIO:='PENDPROV';
                 PRE_MENU_MANT_SERV_FR.COD_STATUS_SERVICIO:='PENDPROV';
                 PRE_MENU_MANT_SERV_FR.FCH_TERMINACION:=FECHAS_SERVICIO_FRM.FCH_
TERMINACION;
                 PRE_MENU_MANT_SERV_FR.NUM_MESES:=FECHAS_SERVICIO_FRM.NUM_MESES;
                END;
           ELSE BEGIN
{              *** SERVICIO NUEVO PERO INCOMPLETO ******* }

                IF (FECHAS_SERVICIO_FRM.CONTEO_60_MESES_TANF_VAR +
                          FECHAS_SERVICIO_FRM.NUM_MESES > 60)  AND
                        (FECHAS_SERVICIO_FRM.RAZON_60_MESES = '') AND
                        (FECHAS_SERVICIO_FRM.COD_SERVICIO = 'AE-C')
                 THEN
                          RETURN;

                IF (FECHAS_SERVICIO_FRM.CONTEO_60_MESES_TANF_VAR +
                          FECHAS_SERVICIO_FRM.NUM_MESES > 72) AND
                        (FECHAS_SERVICIO_FRM.COD_SERVICIO = 'AE-C')
                         THEN
                          RETURN;

                 IF (((RUTINA_GBL='MC') OR (RUTINA_GBL = 'IR') OR (RUTINA_GBL =
'AC'))  AND
                    (AUTORIZADA_GBL = 'N')) OR
                    ((FECHAS_SERVICIO_FRM.CONTEO_60_MESES_TANF_VAR +
                    FECHAS_SERVICIO_FRM.NUM_MESES > 60)  AND
                        (FECHAS_SERVICIO_FRM.COD_SERVICIO = 'AE-C'))

                  THEN BEGIN
                         FECHAS_SERVICIO_FRM.COD_STATUS_SERVICIO:='PENDAUTO';
                         SERV_FAM_FRM.COD_STATUS_SERVICIO:='PENDAUTO';
                         PRE_MENU_MANT_SERV_FR.COD_STATUS_SERVICIO:='PENDAUTO';
                         PRE_MENU_MANT_SERV_FR.FCH_TERMINACION:=FECHAS_SERVICIO_
FRM.FCH_TERMINACION;
                         PRE_MENU_MANT_SERV_FR.NUM_MESES:=FECHAS_SERVICIO_FRM.NU
M_MESES;
                       END;
                  ELSE
                 IF (RUTINA_GBL = 'MC') OR (RUTINA_GBL = 'AC')
                 THEN BEGIN
{ Cambio eftctivo al 13 de marzo
         DB_RESET(OPEN_ID2,STATUS_CODE);
                 SERVICIOS2_DSD.SEGURO_SOCIAL_JEFE_FAM :=
                        FECHAS_SERVICIO_FRM.SEGURO_SOCIAL_JEFE_FAM;
                 SERVICIOS2_DSD.SEGURO_SOCIAL_JEFE_SERV :=
                        FECHAS_SERVICIO_FRM.SEGURO_SOCIAL_JEFE_SERV;
                 SERVICIOS2_DSD.COD_SERVICIO :=
                        FECHAS_SERVICIO_FRM.COD_SERVICIO;
                SERVICIOS2_DSD.RMO_OFICINA := RMO_GBL;
                 DB_QUERY(OPEN_ID2,STATUS_CODE);
                 DB_GET_FIRST(OPEN_ID2,STATUS_CODE);
}
                 IF (FECHAS_SERVICIO_FRM.VLR_BENEFICIOS >= FECHAS_SERVICIO_FRM.V
LR_BENEFICIO_ANTERIOR) OR
                    (FECHAS_SERVICIO_FRM.COD_STATUS_SERVICIO ='ACCNEG') OR
                    (RECERT_TIPO_GBL = 'D') OR (RECERT_TIPO_GBL = 'P') OR
                    (RECERT_TIPO_GBL = 'A') OR (RECERT_TIPO_GBL = 'S')
                    THEN BEGIN
                        IF FECHAS_SERVICIO_FRM.VLR_BENEFICIOS > 0
                        THEN BEGIN
                                FECHAS_SERVICIO_FRM.COD_STATUS_SERVICIO:='ACTIVO
';
                                SERV_FAM_FRM.COD_STATUS_SERVICIO:='ACTIVO';
                                PRE_MENU_MANT_SERV_FR.COD_STATUS_SERVICIO:='ACTI
VO';
                                FECHAS_SERVICIO_FRM.ULT_BENEFICIO := FECHAS_SERV
ICIO_FRM.VLR_BENEFICIO_ANTERIOR;
                                FECHAS_SERVICIO_FRM.VLR_BENEFICIO_ANTERIOR := FE
CHAS_SERVICIO_FRM.VLR_BENEFICIOS;
        {               SERVICIOS2_DSD.VLR_BENEFICIO_ANTERIOR := SERVICIOS2_DSD.
VLR_BENEFICIOS;
                                DB_UPDATE(OPEN_ID2,STATUS_CODE);
                                 DB_COMMIT(OPEN_ID2); }

                                FLAG_UPD_GBL := 'S';
                             END;
                        ELSE BEGIN
                                FECHAS_SERVICIO_FRM.COD_STATUS_SERVICIO:='CERRAD
12';
                                FECHAS_SERVICIO_FRM.FCH_CERRADO := SYSTEM_DATE;
                                SERV_FAM_FRM.COD_STATUS_SERVICIO:='CERRAD12';
                                PRE_MENU_MANT_SERV_FR.COD_STATUS_SERVICIO:='CERR
AD12';
                                FLAG_UPD_GBL := 'S';
                             END;
                      END;
                    ELSE
                     BEGIN
                     {llm Cambio Abril 19 para cerrar casos con beneficio en 0}
                     IF FECHAS_SERVICIO_FRM.VLR_BENEFICIOS > 0
                     THEN BEGIN
                      IF  SUBSTR(FECHAS_SERVICIO_FRM.COD_SERVICIO,0,3) = 'PAN' T
HEN
                        BEGIN
                         FECHAS_SERVICIO_FRM.COD_STATUS_SERVICIO:='ACTIVO';
                         SERV_FAM_FRM.COD_STATUS_SERVICIO:='ACTIVO';
                         PRE_MENU_MANT_SERV_FR.COD_STATUS_SERVICIO:='ACTIVO';
                         PRE_MENU_MANT_SERV_FR.FCH_TERMINACION:=FECHAS_SERVICIO_
FRM.FCH_TERMINACION;
                         FECHAS_SERVICIO_FRM.ULT_BENEFICIO := FECHAS_SERVICIO_FR
M.VLR_BENEFICIO_ANTERIOR;
                         FECHAS_SERVICIO_FRM.VLR_BENEFICIO_ANTERIOR := FECHAS_SE
RVICIO_FRM.VLR_BENEFICIOS;
                         PRE_MENU_MANT_SERV_FR.NUM_MESES:=FECHAS_SERVICIO_FRM.NU
M_MESES;
                         FLAG_UPD_GBL := 'S';
                        END;
                      ELSE
                        BEGIN
                         FECHAS_SERVICIO_FRM.COD_STATUS_SERVICIO:='ACCNEG';

                         SERV_FAM_FRM.COD_STATUS_SERVICIO:='ACCNEG';
                         PRE_MENU_MANT_SERV_FR.COD_STATUS_SERVICIO:='ACCNEG';
                         PRE_MENU_MANT_SERV_FR.FCH_TERMINACION:=FECHAS_SERVICIO_
FRM.FCH_TERMINACION;
                         PRE_MENU_MANT_SERV_FR.NUM_MESES:=FECHAS_SERVICIO_FRM.NU
M_MESES;
                         FLAG_UPD_GBL := 'N';
                        END;
                       END;
                      ELSE
                         BEGIN
                                FECHAS_SERVICIO_FRM.COD_STATUS_SERVICIO:='CERRAD
12';
                                FECHAS_SERVICIO_FRM.FCH_CERRADO := SYSTEM_DATE;
                                SERV_FAM_FRM.COD_STATUS_SERVICIO:='CERRAD12';
                                PRE_MENU_MANT_SERV_FR.COD_STATUS_SERVICIO:='CERR
AD12';
                                FLAG_UPD_GBL := 'S';
                          END;
                      END;
                 IF (RUTINA_GBL = 'AC') OR (RECERT_TIPO_GBL = 'D')
                    THEN BEGIN
                         IF (AUTORIZADA_GBL = 'S') AND
                        (((FECHAS_SERVICIO_FRM.CONTEO_60_MESES_TANF_VAR +
                          FECHAS_SERVICIO_FRM.NUM_MESES > 60)  AND
                        (FECHAS_SERVICIO_FRM.COD_SERVICIO <> 'AE-C')) OR
                        (FECHAS_SERVICIO_FRM.CONTEO_60_MESES_TANF_VAR +
                          FECHAS_SERVICIO_FRM.NUM_MESES <= 60))
                        THEN BEGIN
                          FECHAS_SERVICIO_FRM.COD_STATUS_SERVICIO:='ACTIVO';
                          SERV_FAM_FRM.COD_STATUS_SERVICIO:='ACTIVO';
                          PRE_MENU_MANT_SERV_FR.COD_STATUS_SERVICIO:='ACTIVO';
                          PRE_MENU_MANT_SERV_FR.FCH_TERMINACION:=FECHAS_SERVICIO
_FRM.FCH_TERMINACION;
                          PRE_MENU_MANT_SERV_FR.NUM_MESES:=FECHAS_SERVICIO_FRM.N
UM_MESES;
                          END;
                         ELSE BEGIN
                          FECHAS_SERVICIO_FRM.COD_STATUS_SERVICIO:='PENDAUTO';
                          SERV_FAM_FRM.COD_STATUS_SERVICIO:='PENDAUTO';
                          PRE_MENU_MANT_SERV_FR.COD_STATUS_SERVICIO:='PENDAUTO';
                          PRE_MENU_MANT_SERV_FR.FCH_TERMINACION:=FECHAS_SERVICIO
_FRM.FCH_TERMINACION;
                          PRE_MENU_MANT_SERV_FR.NUM_MESES:=FECHAS_SERVICIO_FRM.N
UM_MESES;
                        IF STATUS_CODE <>0
                        THEN
                                BEGIN
                                ERROR(STATUS_CODE);
                                RETURN;
                                END;
                        {END_IF}
{                DB_RESET(OPEN_ID2,STATUS_CODE);
                 SERVICIOS2_DSD.SEGURO_SOCIAL_JEFE_FAM :=
                        FECHAS_SERVICIO_FRM.SEGURO_SOCIAL_JEFE_FAM;
                 SERVICIOS2_DSD.SEGURO_SOCIAL_JEFE_SERV :=
                        FECHAS_SERVICIO_FRM.SEGURO_SOCIAL_JEFE_SERV;
                 SERVICIOS2_DSD.COD_SERVICIO :=
                        FECHAS_SERVICIO_FRM.COD_SERVICIO;
                 SERVICIOS2_DSD.RMO_OFICINA := RMO_GBL;
                 DB_QUERY(OPEN_ID2,STATUS_CODE);
                 DB_GET_FIRST(OPEN_ID2,STATUS_CODE);
                 SERVICIOS2_DSD.VLR_BENEFICIO_ANTERIOR := SERVICIOS2_DSD.VLR_BEN
EFICIOS;

                 DB_UPDATE(OPEN_ID2,STATUS_CODE);
                 DB_COMMIT(OPEN_ID2);}
                 FECHAS_SERVICIO_FRM.ULT_BENEFICIO := FECHAS_SERVICIO_FRM.VLR_BE
NEFICIO_ANTERIOR;
                 FECHAS_SERVICIO_FRM.VLR_BENEFICIO_ANTERIOR := FECHAS_SERVICIO_F
RM.VLR_BENEFICIOS;
                          END;
                         END;

                END;

        DB_CLOSE(OPEN_ID,STATUS_ID);
        END;
 END;
  END;

{ASIGNAR PROVEEDOR}
IF (MANT_ACCION_SERV_GBL='AP') THEN
BEGIN
    SERV_FAM_FRM.ID_PROVEEDOR := FECHAS_SERVICIO_FRM.ID_PROVEEDOR;
    IF (RECERT_TIPO_GBL = 'N') OR (RECERT_TIPO_GBL = 'D') THEN
        BEGIN
           FECHAS_SERVICIO_FRM.COD_STATUS_SERVICIO:='PENDAUTO';
           SERV_FAM_FRM.COD_STATUS_SERVICIO:='PENDAUTO';
           PRE_MENU_MANT_SERV_FR.COD_STATUS_SERVICIO:='PENDAUTO';
           PRE_MENU_MANT_SERV_FR.FCH_TERMINACION:=FECHAS_SERVICIO_FRM.FCH_TERMIN
ACION;
           PRE_MENU_MANT_SERV_FR.NUM_MESES:=FECHAS_SERVICIO_FRM.NUM_MESES;
        END;
    ELSE
        BEGIN
                FECHAS_SERVICIO_FRM.COD_STATUS_SERVICIO:='ACTIVO';
                SERV_FAM_FRM.COD_STATUS_SERVICIO:='ACTIVO';
                PRE_MENU_MANT_SERV_FR.COD_STATUS_SERVICIO:='ACTIVO';
                PRE_MENU_MANT_SERV_FR.FCH_TERMINACION:=FECHAS_SERVICIO_FRM.FCH_T
ERMINACION;
                PRE_MENU_MANT_SERV_FR.NUM_MESES:=FECHAS_SERVICIO_FRM.NUM_MESES;
        END;
END;

{ REASIGNAR PROVEEDOR }
IF (MANT_ACCION_SERV_GBL = 'RP') THEN
BEGIN
          SERV_FAM_FRM.ID_PROVEEDOR := FECHAS_SERVICIO_FRM.ID_PROVEEDOR;
END;

{AUTORIZAR SERVICIO}
IF (MANT_ACCION_SERV_GBL='AS')
   THEN BEGIN
        if (substr(fechas_servicio_frm.cod_servicio,0,4) = 'PANE') OR
           (substr(fechas_servicio_frm.cod_servicio,0,2) = 'AT')
        THEN
           BEGIN
           FECHAS_SERVICIO_FRM.COD_STATUS_SERVICIO:='CERRAD39';
           FECHAS_SERVICIO_FRM.FCH_CERRADO := SYSTEM_DATE;
           SERV_FAM_FRM.COD_STATUS_SERVICIO:='CERRAD39';
                 PRE_MENU_MANT_SERV_FR.COD_STATUS_SERVICIO:='CERRAD39';
           END;
        ELSE
           BEGIN
           FECHAS_SERVICIO_FRM.COD_STATUS_SERVICIO:='ACTIVO';
           SERV_FAM_FRM.COD_STATUS_SERVICIO:='ACTIVO';
                 PRE_MENU_MANT_SERV_FR.COD_STATUS_SERVICIO:='ACTIVO';
                 {  cambio efectivo al 13 de marzo de 2007
     DB_RESET(OPEN_ID2,STATUS_CODE);
                 SERVICIOS2_DSD.SEGURO_SOCIAL_JEFE_FAM :=
                        FECHAS_SERVICIO_FRM.SEGURO_SOCIAL_JEFE_FAM;
                 SERVICIOS2_DSD.SEGURO_SOCIAL_JEFE_SERV :=
                        FECHAS_SERVICIO_FRM.SEGURO_SOCIAL_JEFE_SERV;
                 SERVICIOS2_DSD.COD_SERVICIO :=
                        FECHAS_SERVICIO_FRM.COD_SERVICIO;
                 SERVICIOS2_DSD.RMO_OFICINA := RMO_GBL;
                 DB_QUERY(OPEN_ID2,STATUS_CODE);
                 DB_GET_FIRST(OPEN_ID2,STATUS_CODE); }

       {          SERVICIOS2_DSD.VLR_BENEFICIO_ANTERIOR := SERVICIOS2_DSD.VLR_BE
NEFICIOS;
                 DB_UPDATE(OPEN_ID2,STATUS_CODE);
                 DB_COMMIT(OPEN_ID2);}

                 FECHAS_SERVICIO_FRM.ULT_BENEFICIO := FECHAS_SERVICIO_FRM.VLR_BE
NEFICIO_ANTERIOR;
                 FECHAS_SERVICIO_FRM.VLR_BENEFICIO_ANTERIOR := FECHAS_SERVICIO_F
RM.VLR_BENEFICIOS;
           END;
        END;
{Db_close(open_id2,status_code);}

{REASIGNAR TSS}
IF (MANT_ACCION_SERV_GBL='AT')
   THEN BEGIN
         SERV_FAM_FRM.ID_TECNICO:=FECHAS_SERVICIO_FRM.ID_TECNICO;
        END;

{ CAMBIAR FECHAS }
IF (MANT_ACCION_SERV_GBL='FS')
   THEN BEGIN
         SERV_FAM_FRM.FCH_TERMINACION:=FECHAS_SERVICIO_FRM.FCH_TERMINACION;
         SERV_FAM_FRM.NUM_MESES:=FECHAS_SERVICIO_FRM.NUM_MESES;
         SERV_FAM_FRM.FCH_COMIENZO := FECHAS_SERVICIO_FRM.FCH_COMIENZO;
         PRE_MENU_MANT_SERV_FR.FCH_COMIENZO:=FECHAS_SERVICIO_FRM.FCH_COMIENZO;
         PRE_MENU_MANT_SERV_FR.FCH_TERMINACION:=FECHAS_SERVICIO_FRM.FCH_TERMINAC
ION;
         PRE_MENU_MANT_SERV_FR.NUM_MESES:=FECHAS_SERVICIO_FRM.NUM_MESES;
        END;

{ CAMBIAR BENEFICIO }
IF (MANT_ACCION_SERV_GBL = 'CB')
 THEN BEGIN
        SERV_FAM_FRM.VLR_BENEFICIO := FECHAS_SERVICIO_FRM.VLR_BENEFICIOS;
      END;

{ CERRAR SERVICIO OR REASIGNAR SERVICIO }
IF (MANT_ACCION_SERV_GBL='CS') OR
   (MANT_ACCION_SERV_GBL='IS')
   THEN BEGIN
           SERV_FAM_FRM.COD_STATUS_SERVICIO:=
                FECHAS_SERVICIO_FRM.COD_STATUS_SERVICIO;
           PRE_MENU_MANT_SERV_FR.COD_STATUS_SERVICIO:=
                FECHAS_SERVICIO_FRM.COD_STATUS_SERVICIO;
                RETURN;
        END;

CALL_CMD(QBE);
CALL_CMD(QUERY);
SET_NOTRACE();
END;





--------------------------------------------------------------------- */
